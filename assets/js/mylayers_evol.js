

var mylayers_evol = [
      {
        type:'step',
        expression :  ['-',['/',['to-number',['get',`ind_snv_2017`]],['to-number',['get', `ind_2017`]]],['/',['to-number',['get',`ind_snv_2015`]],['to-number',['get', `ind_2015`]]]],
        cols : colorbrewer["RdBu"][8],
        name:"snv",
        denom:"ind",
        year:"evol",
        visibility:'visible',
        text:`Niveau de vie moyen`,
        unit: 'Euros',
        format:function(d){return Math.round(d)},
        group:"eco"
      },
      {
      type: 'step',
      expression :  ['-',['*',['/',['to-number',['get',`ind_2017`]],['get', 'area']],100000],['*',['/',['to-number',['get',`ind_2015`]],['get', 'area']],100000]],
      cols : colorbrewer["RdYlGn"][8],
      name:"ind",
      denom:"area",
      year :"evol",
      visibility:'visible',
      steps:[-1000,-500,-250,-100,0,100,250,500,1000],
      text:`Densité de population`,
      unit: 'hab/Km2',
      format:function(d){return Math.round(d)},
      group:'pop'
    },
    {
      type: 'step',
      expression :  ['-',['/',['to-number',['get',`men_pauv_2017`]],['to-number',['get', `men_2017`]]],['/',['to-number',['get',`men_pauv_2015`]],['to-number',['get', `men_2015`]]]],
      name:"pauv",
      denom:"men",
      year :"evol",
      steps:[-0.25,-0.10,-0.05,-0.02,0,0.02,0.05,0.10,0.25],
      cols: colorbrewer["RdGy"][8],
      visibility:'visible',
      text:`Ménages pauvre`,
      unit: 'pts de %',
      format:function(d){return Math.round(d*100)},
      group:'eco'
    },
      {
        type : 'step', 
        expression:['-',['/',['to-number',['get', `men_fmp_2017`]],['to-number',['get',`men_2017`]]],['/',['to-number',['get', `men_fmp_2015`]],['to-number',['get',`men_2015`]]]],
        cols : colorbrewer["RdGy"][8],
        name:"fmp",
        denom:"men",
        year:"evol",
        steps:[-0.25,-0.10,-0.05,-0.02,0,0.02,0.05,0.10,0.25],
        visibility:'visible',
        text:`Familles monoparentales`,
        unit:"pts de %",
        format:function(d){return Math.round(d*100)},
        group:'pop'
      },
      {
        type : 'step', 
        expression:['-',['/',['to-number',['get', `men_5ind_2017`]],['to-number',['get',`men_2017`]]],['/',['to-number',['get', `men_5ind_2015`]],['to-number',['get',`men_2015`]]]],
        cols : colorbrewer["RdGy"][8],
        name:"5ind",
        denom:"men",
        year:"evol",
        steps:[-0.25,-0.10,-0.05,-0.02,0,0.02,0.05,0.10,0.25],
        visibility:'visible',
        text:`Ménages de 5 individus ou plus`,
        unit:"pts de %",
        format:function(d){return Math.round(d*100)},
        group:'pop'
      },
      {
        type : 'step', 
        expression:['-',['/',['to-number',['get', `men_1ind_2017`]],['to-number',['get',`men_2017`]]],['/',['to-number',['get', `men_1ind_2015`]],['to-number',['get',`men_2015`]]]],
        cols : colorbrewer["RdGy"][8],
        name:"1ind",
        denom:"men",
        year:"evol",
        steps:[-0.25,-0.10,-0.05,-0.02,0,0.02,0.05,0.10,0.25],
        visibility:'visible',
        text:`Ménages de 1 individus`,
        unit:"pts de %",
        format:function(d){return Math.round(d*100)},
        group:'pop'
      },
      {
      type: 'step',
      expression :  ['-',['/',['to-number',['get',`men_prop_2017`]],['to-number',['get', `men_2017`]]],['/',['to-number',['get',`men_prop_2015`]],['to-number',['get', `men_2015`]]]],
      name:"prop",
      denom:"men",
      year :"evol",
      cols: colorbrewer["PuOr"][8],
      visibility:'visible',
      text:`Ménages propriétaires`,
      steps:[-0.25,-0.10,-0.05,-0.02,0,0.02,0.05,0.10,0.25],
      unit:"pts de %",
      format:function(d){return Math.round(d*100)},
      group:'log'
    },
  {
      type: 'step',
      expression :  ['-',['/',['to-number',['get',`men_coll_2017`]],['to-number',['get', `men_2017`]]],['/',['to-number',['get',`men_coll_2015`]],['to-number',['get', `men_2015`]]]],
      name:"coll",
      denom:"men",
      year :"evol",
      steps:[-0.25,-0.10,-0.05,-0.02,0,0.02,0.05,0.10,0.25],
      cols: colorbrewer["PuOr"][8],
      visibility:'visible',
      text:`Ménages en logement collectifs`,
      unit:"pts de %",
      format:function(d){return Math.round(d*100)},
      group:'log'
    },
    {
      type: 'step',
      expression :  ['-',['/',['to-number',['get',`men_mais_2017`]],['to-number',['get', `men_2017`]]],['/',['to-number',['get',`men_mais_2015`]],['to-number',['get', `men_2015`]]]],
      name:"mais",
      denom:"men",
      year :"evol",
      steps:[-0.25,-0.10,-0.05,-0.02,0,0.02,0.05,0.10,0.25],
      cols: colorbrewer["PuOr"][8],
      visibility:'visible',
      text:`Ménages en maison individuelle`,
      unit:"pts de %",
      format:function(d){return Math.round(d*100)},
      group:'log'
    },
    {
      type: 'step',
      expression :  ['-',['/',['to-number',['get',`log_soc_2017`]],['to-number',['get', `men_2017`]]],['/',['to-number',['get',`log_soc_2015`]],['to-number',['get', `men_2015`]]]],
      name:"soc",
      denom:"log",
      year :"evol",
      steps:[-0.25,-0.10,-0.05,-0.02,0,0.02,0.05,0.10,0.25],
      cols: colorbrewer["PuOr"][8],
      visibility:'visible',
      text:`Ménages en logement social`,
      unit:"pts de %",
      format:function(d){return Math.round(d*100)},
      group:'log'
    },
    {
      type: 'step',
      expression :  ['-',['/',['to-number',['get',`men_surf_2017`]],['to-number',['get', `men_2017`]]],['/',['to-number',['get',`men_surf_2015`]],['to-number',['get', `men_2015`]]]],
      name:"surf",
      denom:"men",
      year :"evol",
      steps:[-0.25,-0.10,-0.05,-0.02,0,0.02,0.05,0.10,0.25],
      cols: colorbrewer["YlGn"][8],
      visibility:'visible',
      text:`Surface moyenne des logements`,
      unit:"m2",
      format:function(d){return Math.round(d)},
      group:'log'
    },

    {
      type: 'step',
      expression :  ['-',['/',['to-number',['get',`log_av45_2017`]],['to-number',['get', `men_2017`]]],['/',['to-number',['get',`log_av45_2015`]],['to-number',['get', `men_2015`]]]],
      name:"av45",
      denom:"log",
      year :"evol",
      steps:[-0.25,-0.10,-0.05,-0.02,0,0.02,0.05,0.10,0.25],
      cols: colorbrewer["BrBG"][8],
      visibility:'visible',
      text:`Logements construits avant 1945`,
      unit:"pts de %",
      format:function(d){return Math.round(d*100)},
      group:'log'
    },
    {
      type: 'step',
      expression :  ['-',['/',['to-number',['get',`log_45_70_2017`]],['to-number',['get', `men_2017`]]],['/',['to-number',['get',`log_45_70_2015`]],['to-number',['get', `men_2015`]]]],
      name:"45_70",
      denom:"log",
      year :"evol",
      steps:[-0.25,-0.10,-0.05,-0.02,0,0.02,0.05,0.10,0.25],
      cols: colorbrewer["BrBG"][8],
      visibility:'visible',
      text:`Logements construits entre 1945 et 1970`,
      unit:"pts de %",
      format:function(d){return Math.round(d*100)},
      group:'log'
    },
    {
      type: 'step',
      expression :  ['-',['/',['to-number',['get',`log_70_90_2017`]],['to-number',['get', `men_2017`]]],['/',['to-number',['get',`log_70_90_2015`]],['to-number',['get', `men_2015`]]]],
      name:"70_90",
      denom:"log",
      year :"evol",
      steps:[-0.25,-0.10,-0.05,-0.02,0,0.02,0.05,0.10,0.25],
      cols: colorbrewer["BrBG"][8],
      visibility:'visible',
      text:`Logements construits entre 1970 et 1990`,
      unit:"pts de %",
      format:function(d){return Math.round(d*100)},
      group:'log'
    },

    {
      type: 'step',
      expression :  ['-',['/',['to-number',['get',`log_ap90_2017`]],['to-number',['get', `men_2017`]]],['/',['to-number',['get',`log_ap90_2015`]],['to-number',['get', `men_2015`]]]],
      name:"ap90",
      denom:"log",
      year :"evol",
      steps:[-0.25,-0.10,-0.05,-0.02,0,0.02,0.05,0.10,0.25],
      cols: colorbrewer["BrBG"][8],
      visibility:'visible',
      text:`Logements construits après 1990`,
      unit:"pts de %",
      format:function(d){return Math.round(d*100)},
      group:'log'
    },
    {
      type: 'step',
      expression :  ['-',['/',['to-number',['get',`ind_0_3_2017`]],['to-number',['get', `ind_2017`]]],['/',['to-number',['get',`ind_0_3_2015`]],['to-number',['get', `ind_2015`]]]],
      name:"0_3",
      denom:"ind",
      year :"evol",
      steps:[-0.25,-0.10,-0.05,-0.02,0,0.02,0.05,0.10,0.25],
      cols: colorbrewer["PiYG"][8],
      visibility:'visible',
      text:`0 - 3 ans`,
      unit:"pts de %",
      format:function(d){return Math.round(d*100)},
      group:'log'
    }
    ,
    {
      type: 'step',
      expression :  ['-',['/',['to-number',['get',`ind_4_5_2017`]],['to-number',['get', `ind_2017`]]],['/',['to-number',['get',`ind_4_5_2015`]],['to-number',['get', `ind_2015`]]]],
      name:"4_5",
      denom:"ind",
      year :"evol",
      steps:[-0.25,-0.10,-0.05,-0.02,0,0.02,0.05,0.10,0.25],
      cols: colorbrewer["PiYG"][8],
      visibility:'visible',
      text:`4 - 5 ans`,
      unit:"pts de %",
      format:function(d){return Math.round(d*100)},
      group:'log'
    },
    {
      type: 'step',
      expression :  ['-',['/',['to-number',['get',`ind_6_10_2017`]],['to-number',['get', `ind_2017`]]],['/',['to-number',['get',`ind_6_10_2015`]],['to-number',['get', `ind_2015`]]]],
      name:"6_10",
      denom:"ind",
      year :"evol",
      steps:[-0.25,-0.10,-0.05,-0.02,0,0.02,0.05,0.10,0.25],
      cols: colorbrewer["PiYG"][8],
      visibility:'visible',
      text:`6 - 10 ans`,
      unit:"pts de %",
      format:function(d){return Math.round(d*100)},
      group:'log'
    },
    {
      type: 'step',
      expression :  ['-',['/',['to-number',['get',`ind_11_17_2017`]],['to-number',['get', `ind_2017`]]],['/',['to-number',['get',`ind_11_17_2015`]],['to-number',['get', `ind_2015`]]]],
      name:"11_17",
      denom:"ind",
      year :"evol",
      steps:[-0.25,-0.10,-0.05,-0.02,0,0.02,0.05,0.10,0.25],
      cols: colorbrewer["PiYG"][8],
      visibility:'visible',
      text:`11 - 17 ans`,
      unit:"pts de %",
      format:function(d){return Math.round(d*100)},
      group:'log'
    },
    {
      type: 'step',
      expression :  ['-',['/',['to-number',['get',`ind_18_24_2017`]],['to-number',['get', `ind_2017`]]],['/',['to-number',['get',`ind_18_24_2015`]],['to-number',['get', `ind_2015`]]]],
      name:"18_24",
      denom:"ind",
      year :"evol",
      steps:[-0.25,-0.10,-0.05,-0.02,0,0.02,0.05,0.10,0.25],
      cols: colorbrewer["PRGn"][8],
      visibility:'visible',
      text:`18 - 24 ans`,
      unit:"pts de %",
      format:function(d){return Math.round(d*100)},
      group:'log'
    },
    {
      type: 'step',
      expression :  ['-',['/',['to-number',['get',`ind_25_39_2017`]],['to-number',['get', `ind_2017`]]],['/',['to-number',['get',`ind_25_39_2015`]],['to-number',['get', `ind_2015`]]]],
      name:"25_39",
      denom:"ind",
      year :"evol",
      steps:[-0.25,-0.10,-0.05,-0.02,0,0.02,0.05,0.10,0.25],
      cols: colorbrewer["PRGn"][8],
      visibility:'visible',
      text:`25 - 39 ans`,
      unit:"pts de %",
      format:function(d){return Math.round(d*100)},
      group:'log'
    },
    {
      type: 'step',
      expression :  ['-',['/',['to-number',['get',`ind_40_54_2017`]],['to-number',['get', `ind_2017`]]],['/',['to-number',['get',`ind_40_54_2015`]],['to-number',['get', `ind_2015`]]]],
      name:"40_54",
      denom:"ind",
      year :"evol",
      steps:[-0.25,-0.10,-0.05,-0.02,0,0.02,0.05,0.10,0.25],
      cols: colorbrewer["PRGn"][8],
      visibility:'visible',
      text:`40 - 54 ans`,
      unit:"pts de %",
      format:function(d){return Math.round(d*100)},
      group:'log'
    },
      {
      type: 'step',
      expression :  ['-',['/',['to-number',['get',`ind_55_64_2017`]],['to-number',['get', `ind_2017`]]],['/',['to-number',['get',`ind_55_64_2015`]],['to-number',['get', `ind_2015`]]]],
      name:"55_64",
      denom:"ind",
      year :"evol",
      steps:[-0.25,-0.10,-0.05,-0.02,0,0.02,0.05,0.10,0.25],
      cols: colorbrewer["PRGn"][8],
      visibility:'visible',
      text:`55 - 64 ans`,
      unit:"pts de %",
      format:function(d){return Math.round(d*100)},
      group:'log'
    },
      {
      type: 'step',
      expression :  ['-',['/',['to-number',['get',`ind_65_79_2017`]],['to-number',['get', `ind_2017`]]],['/',['to-number',['get',`ind_65_79_2015`]],['to-number',['get', `ind_2015`]]]],
      name:"65_79",
      denom:"ind",
      year :"evol",
      steps:[-0.25,-0.10,-0.05,-0.02,0,0.02,0.05,0.10,0.25],
      cols: colorbrewer["PuOr"][8],
      visibility:'visible',
      text:`65 - 79 ans`,
      unit:"pts de %",
      format:function(d){return Math.round(d*100)},
      group:'log'
    },
      {
      type: 'step',
      expression :  ['-',['/',['to-number',['get',`ind_80p_2017`]],['to-number',['get', `ind_2017`]]],['/',['to-number',['get',`ind_80p_2015`]],['to-number',['get', `ind_2015`]]]],
      name:"80p",
      denom:"ind",
      year :"evol",
      steps:[-0.25,-0.10,-0.05,-0.02,0,0.02,0.05,0.10,0.25],
      cols: colorbrewer["PuOr"][8],
      visibility:'visible',
      text:`Plus de 80 ans`,
      unit:"pts de %",
      format:function(d){return Math.round(d*100)},
      group:'log'
    }
    
    ]